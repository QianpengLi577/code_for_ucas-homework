### <center>Probabilistic Graphical Model</center>
概率图模型有什么用？概率图是在图的基础上添加了概率信息，通过图可以得到概率密度分布函数。对于离散或者连续型N维向量，用N个结点的图表示出样本的概率密度分布。当学到了事物的概率模型，就可以完成很多有意思的任务，比如说图像降噪、图像生成、语音识别。了解概率图模型，就要从模型的[表示](#表示)、[学习](#学习)、[推理](#推理)进行学习。

#### 表示

前情提要：
概率链式法则如下

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-32-15.png)

边缘概率

<center class = "half">
    <img src = 'https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-32-54.png'  width = '50%' align = left/><img src = 'https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-32-59.png'  width = '50%' align = right/>
</center>

图分为两种：有向图和无向图

##### 有向图模型

有向图表示了变量之间的依赖关系，一般称为贝叶斯网络

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-38-07.png)

如下图，b依赖于a，c依赖于a、b，那么这个有向图表示的全概率公式

![图1](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-38-29.png)

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-40-17.png)

同样的对于下图贝叶斯网络，有全概率公式

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-43-25.png)

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-43-31.png)

对于有向图，有个叫做条件独立性的特性。条件独立性指的是当条件给定是，某两个变量在这个条件下相互独立。在有向图中，如果两个结点直接相连，那么这两个结点一定是非条件独立的，他们具有因果性。父节点为因，子结点为果。如果两个结点不是直接相连的，但是他们之间有一条经过其他结点的路径连接，此时他们的条件独立性比较复杂。

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-43-50.png)

对于ab，当x2给定时，x1、x3条件独立

对于c，当x2给定时，x1、x3条件独立，当x2未定，不独立

对于d，当x2给定时，x1、x3非条件独立，x2未定，条件独立

##### 无向图模型

无向图模型，一般称为马尔可夫随机场

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-45-02.png)

由于无向图没有指定变量依赖关系，因此没有办法通过条件链式法则表示出概率密度函数。因此需要引入其他概念来表示概率密度函数。

团：

团是一个连同的子图，最大团指的是：团添加任意顶点后，不能成为团，则称之为最大团。如下图，一共有：{x1,x3}\{x1,x2}\{x2,x4}\{x3,x4}\{x2,x3}\{x1,x2,x3}\{x2,x3,x4}7个团，最后两个团为最大团。

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-45-21.png)

无向图的联合概率密度定义为一系列最大团上的非负函数(也称为势函数)的乘积形式。式中E(Xc)为能量函数，Z为配分函数(用于归一化)

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-45-47.png)

对于不同的无向图模型，选择的能量函数也各不相同，这里就不再详述

我们可以看到无向图和有向图的区别实际上还是蛮大的，那么有没有一种方法将有向图转换为无向图，这样我们就可以直接研究无向图。
对于链：

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-46-15.png)

分别写出有向和无向的概率密度分布函数，可以发现条件概率似乎和势函数有着某种对应关系。为了将一般的有向图转换成无向图，有学者提出了道德化方法。它的思想是将一个结点的多个父节点两两之间用无向边进行连接。如下图，x4的父节点为x1、x2、x3，将父节点两两相连并将有向箭头变为无向边

![](https://raw.githubusercontent.com/QianpengLi577/code_for_ucas-homework/main/ML/Probabilistic%20Graphical%20Model/Pic/2022-05-14-10-46-44.png)

#### 学习

由于学习不是课程的重点，此处仅对一些常用的学习方法进行总结：

##### 不含隐结点的

极大似然估计、梯度下降

##### 含隐结点的

EM

#### 推理

概率图模型的推理方式主要有两种：精确推断和近似推断。

精确推断主要是将边缘概率的计算通过某种方式组合在一起，及减少时间复杂度。比如变量消去、信念传播、sum-product、max-sum。前三者是计算边际分布，最后一个是计算概率值


由于精确推断仅适用于树状图，计算量也比较大，近似计算弥补了这个缺陷。比如变分推断、马尔可夫蒙特卡洛采样
